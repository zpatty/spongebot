clear
d = 0.04;
L0 = 0.12;
hm = 0.06;
num = 100000/2;
p = zeros(3,num);
for i = 1:num*2

    if i < num/2
        lr = zeros(4,1);
    elseif i < num
        lr = -0.07999*ones(4,1);
    else
        l0 = -0.07999;
        l1 = 0;
        lr = (l1-l0).*rand(4,1) + l0;
    end
    dxr = zeros(4,1);
    dyr = zeros(4,1);
    for j = 1:4
        del = asin((L0+lr(j))/3/d)*d;
        dx0 = -del;
        dx1 = del;
        dxr(j) = (dx1-dx0).*rand(1,1) + dx0;
        % dy0 = -sqrt(del^2-dxr(j)^2);
        % dy1 = sqrt(del^2-dxr(j)^2);
        % dyr(j) = (dy1-dy0).*rand(1,1) + dy0;
    end
    th0 = -pi/4;
    th1 = pi/4;
    thr = (th1-th0).*rand(3,1) + th0;
    base0 = -pi/4;
    base1 = pi/4;
    baser = 0; %(base1-base0).*rand(1,1) + base0;
    qr = [baser;dxr(1);dyr(1);lr(1);thr(1);dxr(2);dyr(2);lr(2);thr(2);dxr(3);dyr(3);lr(3);thr(3);dxr(4);dyr(4);lr(4)];
    [J_r, x_r] = J_r_4(qr,L0,d,hm); %puppet_end_transform(qr,d,L0,hm);
    p(:,i) = x_r;
end

% scatter3(p(1,:),p(2,:),p(3,:) + (0.68 - 0.657),5,p(3,:))
scatter(p(1,:),p(3,:) + (0.68 - 0.657),5,p(3,:),'filled')

xlabel('$x$ (m)', 'Interpreter', 'latex', 'FontSize', 28)
% ylabel('$y$ (m)', 'Interpreter', 'latex', 'FontSize', 28)
ylabel('$z$ (m)', 'Interpreter', 'latex', 'FontSize', 28)
axis equal
set(gca,'FontSize',14)
h = gcf;

ax = gca;
% Set the font size
set(ax, 'FontSize', 24)
% Set the interpreter for the tick labels
set(ax, 'TickLabelInterpreter', 'latex')

% Modify the figure size
set(gcf, 'Position', [303 495 560 660])


% Get the legend and set its interpreter
% l = findobj(gcf, 'Type', 'legend');
% set(l, 'Interpreter', 'latex')

% Turn on grid and box
grid on
box on 
fig = gcf;
save_fig = 0;
if save_fig == 1
    print(fig, "workspace", '-dpdf', '-vector')
end
function p = puppet_end_transform(q,d,L0,hm)
th3 = q(1);
dx1 = q(2);
dy1 = q(3);
dL1 = q(4);
th1 = q(5);
dx2 = q(6);
dy2 = q(7);
dL2 = q(8);
th2 = q(9);
dx3 = q(10);
dy3 = q(11);
dL3 = q(12);

g = [(dx3*sin((dx3^2 + dy3^2)^(1/2)/d)*(sin(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)) - cos(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2))))/(dx3^2 + dy3^2)^(1/2) - (cos(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)) + sin(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2)))*((dx3^2*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1))/(dx3^2 + dy3^2) + 1) - (dx3*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2))*((dy2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dx2*dy2*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2)))/(dx3^2 + dy3^2), (dy3*sin((dx3^2 + dy3^2)^(1/2)/d)*(sin(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)) - cos(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2))))/(dx3^2 + dy3^2)^(1/2) - ((dy3^2*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1))/(dx3^2 + dy3^2) + 1)*(((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2))*((dy2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dx2*dy2*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2)) - (dx3*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(cos(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)) + sin(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2))))/(dx3^2 + dy3^2), - cos((dx3^2 + dy3^2)^(1/2)/d)*(sin(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)) - cos(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2))) - (dx3*sin((dx3^2 + dy3^2)^(1/2)/d)*(cos(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)) + sin(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2))))/(dx3^2 + dy3^2)^(1/2) - (dy3*sin((dx3^2 + dy3^2)^(1/2)/d)*(((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2))*((dy2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dx2*dy2*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2)))/(dx3^2 + dy3^2)^(1/2), hm*sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - hm*sin(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)) + hm*cos(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2)) + (d*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0 + dL2)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (hm*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2) - (d*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0 + dL3)*(sin(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)) - cos(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2))))/(dx3^2 + dy3^2)^(1/2) - (d*(L0 + dL1)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2) + (d*dy2*(L0 + dL2)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2) + (d*dx3*(L0 + dL3)*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(cos(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)) + sin(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2))))/(dx3^2 + dy3^2) + (d*dy3*(L0 + dL3)*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(((sin(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2))*((dy2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dx2*dy2*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2)))/(dx3^2 + dy3^2) - (d*dx2*(L0 + dL2)*(cos(th1)*((cos(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) - (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dx1*cos(th3) - dy1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2); (dx3*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(((dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2)))/(dx3^2 + dy3^2) - (dx3*sin((dx3^2 + dy3^2)^(1/2)/d)*(cos(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2)) + sin(th2)*(((dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2) - (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^(1/2) - ((dy3^2 + dx3^2*cos((dx3^2 + dy3^2)^(1/2)/d))*(sin(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2)) - cos(th2)*(((dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2) - (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2))))/(dx3^2 + dy3^2), ((dx3^2 + dy3^2*cos((dx3^2 + dy3^2)^(1/2)/d))*(((dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2)))/(dx3^2 + dy3^2) - (dy3*sin((dx3^2 + dy3^2)^(1/2)/d)*(cos(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2)) + sin(th2)*(((dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2) - (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^(1/2) - (dx3*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(sin(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2)) - cos(th2)*(((dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2) - (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2))))/(dx3^2 + dy3^2), cos((dx3^2 + dy3^2)^(1/2)/d)*(cos(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2)) + sin(th2)*(((dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2) - (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2))) - (dx3*sin((dx3^2 + dy3^2)^(1/2)/d)*(sin(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2)) - cos(th2)*(((dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2) - (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^(1/2) + (dy3*sin((dx3^2 + dy3^2)^(1/2)/d)*(((dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2)))/(dx3^2 + dy3^2)^(1/2), hm*sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + hm*cos(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2)) + hm*sin(th2)*(((dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2) - (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)) + (d*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0 + dL2)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (d*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0 + dL3)*(cos(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2)) + sin(th2)*(((dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2) - (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2))))/(dx3^2 + dy3^2)^(1/2) + (hm*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2) - (d*(L0 + dL1)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2) - (d*dy2*(L0 + dL2)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2) - (d*dx2*(L0 + dL2)*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + (d*dx3*(L0 + dL3)*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(sin(th2)*(cos((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2)^(1/2)) - cos(th2)*(((dy2^2 + dx2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2) - (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2))))/(dx3^2 + dy3^2) - (d*dy3*(L0 + dL3)*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(((dx2^2 + dy2^2*cos((dx2^2 + dy2^2)^(1/2)/d))*((cos(th3)*(dx1^2 + dy1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*sin(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)))/(dx2^2 + dy2^2) - (dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(sin(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) + (cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy2*(cos(th1)*((sin(th3)*(dy1^2 + dx1^2*cos((dx1^2 + dy1^2)^(1/2)/d)))/(dx1^2 + dy1^2) + (dx1*dy1*cos(th3)*(cos((dx1^2 + dy1^2)^(1/2)/d) - 1))/(dx1^2 + dy1^2)) - (sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1)*(dy1*cos(th3) + dx1*sin(th3)))/(dx1^2 + dy1^2)^(1/2))*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2)))/(dx3^2 + dy3^2); (dx3*sin((dx3^2 + dy3^2)^(1/2)/d)*(sin(th2)*((cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))) + cos(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - cos((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)) + (dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)))))/(dx3^2 + dy3^2)^(1/2) - (cos(th2)*((cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))) - sin(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - cos((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)) + (dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2))))*((dx3^2*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1))/(dx3^2 + dy3^2) + 1) - (dx3*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*((dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*((dy2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1))/(dx1^2 + dy1^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)))/(dx3^2 + dy3^2), (dy3*sin((dx3^2 + dy3^2)^(1/2)/d)*(sin(th2)*((cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))) + cos(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - cos((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)) + (dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)))))/(dx3^2 + dy3^2)^(1/2) - ((dy3^2*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1))/(dx3^2 + dy3^2) + 1)*((dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*((dy2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1))/(dx1^2 + dy1^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)) - (dx3*dy3*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(cos(th2)*((cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))) - sin(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - cos((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)) + (dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)))))/(dx3^2 + dy3^2), - cos((dx3^2 + dy3^2)^(1/2)/d)*(sin(th2)*((cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))) + cos(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - cos((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)) + (dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)))) - (dy3*sin((dx3^2 + dy3^2)^(1/2)/d)*((dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*((dy2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1))/(dx1^2 + dy1^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)))/(dx3^2 + dy3^2)^(1/2) - (dx3*sin((dx3^2 + dy3^2)^(1/2)/d)*(cos(th2)*((cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))) - sin(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - cos((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)) + (dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)))))/(dx3^2 + dy3^2)^(1/2), hm*cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - hm*sin(th2)*((cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))) - hm*cos(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - cos((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)) + (dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2))) + (d*sin((dx1^2 + dy1^2)^(1/2)/d)*(L0 + dL1))/(dx1^2 + dy1^2)^(1/2) + (d*sin((dx2^2 + dy2^2)^(1/2)/d)*(L0 + dL2)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - (dx1*hm*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2) - (d*sin((dx3^2 + dy3^2)^(1/2)/d)*(L0 + dL3)*(sin(th2)*((cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))) + cos(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - cos((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)) + (dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)))))/(dx3^2 + dy3^2)^(1/2) + (d*dy3*(L0 + dL3)*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*((dy2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dy1*sin((dx1^2 + dy1^2)^(1/2)/d)*((dy2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1))/(dx1^2 + dy1^2)^(1/2) + (dx2*dy2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)))/(dx3^2 + dy3^2) + (d*dx2*(L0 + dL2)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2) + (d*dx3*(L0 + dL3)*(cos((dx3^2 + dy3^2)^(1/2)/d) - 1)*(cos(th2)*((cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2))*((dx2^2*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/(dx2^2 + dy2^2) + 1) + (dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) + (dx2*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2))) - sin(th2)*((dx2*sin((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*sin(th1) + (dx1*cos(th1)*sin((dx1^2 + dy1^2)^(1/2)/d))/(dx1^2 + dy1^2)^(1/2)))/(dx2^2 + dy2^2)^(1/2) - cos((dx2^2 + dy2^2)^(1/2)/d)*(cos((dx1^2 + dy1^2)^(1/2)/d)*cos(th1) - (dx1*sin((dx1^2 + dy1^2)^(1/2)/d)*sin(th1))/(dx1^2 + dy1^2)^(1/2)) + (dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*sin((dx2^2 + dy2^2)^(1/2)/d))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)^(1/2)))))/(dx3^2 + dy3^2) + (d*dy1*dy2*sin((dx1^2 + dy1^2)^(1/2)/d)*(L0 + dL2)*(cos((dx2^2 + dy2^2)^(1/2)/d) - 1))/((dx1^2 + dy1^2)^(1/2)*(dx2^2 + dy2^2)); 0, 0, 0, 1];
p = g(1:3,4);
end