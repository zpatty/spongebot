%% cup experiment
d = 0.04337;

theta = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
        0 0 0 1.5 1.5 1.5 1.5 1.5 1.5 1.5 0 0 0 1.5 1.5 1.5 1.5;
        0 0 0 1.5 1.5 1.5 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0 0;
        0 0 0 0.7 0.7 0.2 0.2 0.2 0.2 1.0 1.0 1.0 1.0 0.5 0.0 0 0];

phi = [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
        0 0 0 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5;
        0 0 0 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5;
        0 0 0 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 9.0 9.0 9.0 9.0 9.0 9.0];
dL = [-0.04 -0.11 -0.11 -0.11 -0.11 -0.11 -0.11 -0.11 -0.11 -0.11 -0.11 -0.11 -0.11 -0.11 -0.11 -0.11 -0.11;
    -0.03 -0.04 -0.06 -0.06 -0.06 -0.06 -0.06 -0.06 -0.06 -0.06 -0.11 -0.11 -0.11 -0.11 -0.08 -0.08 -0.08;
    -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.04 -0.04 -0.04 -0.04 -0.04 -0.04 -0.04 -0.04 -0.04 -0.04 -0.02;
    -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0 -0.0];

dx = theta.*d.*cos(phi);
dy = theta.*d.*sin(phi);

motor = [0 0 1.65 1.65 1.65 1.65 1.65 1.65 1.65 1.65 1.68 1.68 1.68 1.68 2.8 2.8 2.8;
        -1.2 0 -1.0 -1.0 -0.5 -0.1 0.3 0.8 1.1 1.1 0.8 0.2 -0.3 -0.9 -0.6 0.4 0.4;
        -0.5 0 1.31 1.31 1.31 1.28 1.0 0.6 0.3 0.3 0.5 1.1 1.1 0.7 0.7 1.0 1.0;
        -1.2 0 0.0 0.95 0.3 -0.2 0.0 0.0 0.0 1.0 1.0 0.7 1.1 1.1 1.6 1.6 1.6];
wayPoints = [motor(1,:);dx(1,:);dy(1,:);dL(1,:);motor(2,:);dx(2,:);dy(2,:);dL(2,:);motor(3,:);
    dx(3,:);dy(3,:);dL(3,:); motor(4,:); dx(4,:);dy(4,:);dL(4,:)];

timePoints = [0 3 6 8 10 13 15 17 18 19 22 24 26 29 32 34 36];

tvec = 0:0.005:50;
tSamples = length(tvec);
[qd,dqd,ddqd,pp] = cubicpolytraj(wayPoints,timePoints,tvec);

save("weight/qd.mat", "qd")
save("weight/dqd.mat", "dqd")
save("weight/ddqd.mat", "ddqd")
save("weight/tvec.mat", "tvec")